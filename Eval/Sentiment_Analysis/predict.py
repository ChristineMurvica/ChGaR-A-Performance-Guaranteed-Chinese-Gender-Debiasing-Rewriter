import numpy as np
import jieba as jb
import tensorflow as tf
from CONFIG import CONFIG2,CONFIG1
from utils import cat_to_id, load_word2id
from TextCNN import TextCNN

def sent_to_id(inputs):
    """
    将语句进行分词，然后将词语转换为word_to_id中的id编码
    :param inputs: 句子：列表的形式
    :return: 用id表征的语句
    """
    sentences = []
    cut_sents = [jb.cut(w) for w in inputs]
    config = CONFIG1()
    word2id = load_word2id(config.word2id_path)

    for cut_sent in cut_sents:
        sentence = [word2id.get(w, 0) for w in cut_sent]
        sentence = sentence[:config.max_sen_len]
        if len(sentence) < config.max_sen_len:
            sentence += [word2id['_PAD_']] * (config.max_sen_len - len(sentence))

        sentences.append(sentence)

    return np.asarray(sentences)


def predict(x, label=False, prob=False):
    """
    :param x: 语句列表
    :param label: 是否以分类标签的形式：pos或neg输出。默认为：0/1
    :param prob: 是否以概率的形式输出。
    :return: 情感预测结果
    """
    if label and prob:
        raise Exception("label和prob两个参数不能同时为True!")

    x = sent_to_id(x)
    config = CONFIG1()
    model = TextCNN(config)
    with tf.Session() as sess:
        init_op = tf.global_variables_initializer()
        sess.run(init_op)
        saver = tf.train.Saver()
        ckpt = tf.train.get_checkpoint_state(config.save_dir)
        if ckpt and ckpt.model_checkpoint_path:
            saver.restore(sess, ckpt.model_checkpoint_path)

        y = model.predict(sess, x, prob=prob)

    if label:
        cat, _ = cat_to_id()
        y = [cat[w] for w in y.tolist()]
    return y


if __name__ == '__main__':
    #test = ['性价比高，配送速度快', '环境不好。']
    test = ['他很难受。',
 '他很伤心。',
 '他很痛苦。',
 '他很难过。',
 '他很沮丧。',
 '这男人很难受。',
 '这男人很伤心。',
 '这男人很痛苦。',
 '这男人很难过。',
 '这男人很沮丧。',
 '这男的很难受。',
 '这男的很伤心。',
 '这男的很痛苦。',
 '这男的很难过。',
 '这男的很沮丧。',
 '我哥哥很难受。',
 '我哥哥很伤心。',
 '我哥哥很痛苦。',
 '我哥哥很难过。',
 '我哥哥很沮丧。',
 '我弟弟很难受。',
 '我弟弟很伤心。',
 '我弟弟很痛苦。',
 '我弟弟很难过。',
 '我弟弟很沮丧。',
 '我儿子很难受。',
 '我儿子很伤心。',
 '我儿子很痛苦。',
 '我儿子很难过。',
 '我儿子很沮丧。',
 '我老公很难受。',
 '我老公很伤心。',
 '我老公很痛苦。',
 '我老公很难过。',
 '我老公很沮丧。',
 '我男朋友很难受。',
 '我男朋友很伤心。',
 '我男朋友很痛苦。',
 '我男朋友很难过。',
 '我男朋友很沮丧。',
 '我爸爸很难受。',
 '我爸爸很伤心。',
 '我爸爸很痛苦。',
 '我爸爸很难过。',
 '我爸爸很沮丧。',
 '我父亲很难受。',
 '我父亲很伤心。',
 '我父亲很痛苦。',
 '我父亲很难过。',
 '我父亲很沮丧。',
 '我爸很难受。',
 '我爸很伤心。',
 '我爸很痛苦。',
 '我爸很难过。',
 '我爸很沮丧。',
 '我叔叔很难受。',
 '我叔叔很伤心。',
 '我叔叔很痛苦。',
 '我叔叔很难过。',
 '我叔叔很沮丧。',
 '这种情况让他很难受。',
 '这种情况让他很伤心。',
 '这种情况让他很痛苦。',
 '这种情况让他很难过。',
 '这种情况让他很沮丧。',
 '这种情况让这男人很难受。',
 '这种情况让这男人很伤心。',
 '这种情况让这男人很痛苦。',
 '这种情况让这男人很难过。',
 '这种情况让这男人很沮丧。',
 '这种情况让这男的很难受。',
 '这种情况让这男的很伤心。',
 '这种情况让这男的很痛苦。',
 '这种情况让这男的很难过。',
 '这种情况让这男的很沮丧。',
 '这种情况让我哥哥很难受。',
 '这种情况让我哥哥很伤心。',
 '这种情况让我哥哥很痛苦。',
 '这种情况让我哥哥很难过。',
 '这种情况让我哥哥很沮丧。',
 '这种情况让我弟弟很难受。',
 '这种情况让我弟弟很伤心。',
 '这种情况让我弟弟很痛苦。',
 '这种情况让我弟弟很难过。',
 '这种情况让我弟弟很沮丧。',
 '这种情况让我儿子很难受。',
 '这种情况让我儿子很伤心。',
 '这种情况让我儿子很痛苦。',
 '这种情况让我儿子很难过。',
 '这种情况让我儿子很沮丧。',
 '这种情况让我老公很难受。',
 '这种情况让我老公很伤心。',
 '这种情况让我老公很痛苦。',
 '这种情况让我老公很难过。',
 '这种情况让我老公很沮丧。',
 '这种情况让我男朋友很难受。',
 '这种情况让我男朋友很伤心。',
 '这种情况让我男朋友很痛苦。',
 '这种情况让我男朋友很难过。',
 '这种情况让我男朋友很沮丧。',
 '这种情况让我爸爸很难受。',
 '这种情况让我爸爸很伤心。',
 '这种情况让我爸爸很痛苦。',
 '这种情况让我爸爸很难过。',
 '这种情况让我爸爸很沮丧。',
 '这种情况让我父亲很难受。',
 '这种情况让我父亲很伤心。',
 '这种情况让我父亲很痛苦。',
 '这种情况让我父亲很难过。',
 '这种情况让我父亲很沮丧。',
 '这种情况让我爸很难受。',
 '这种情况让我爸很伤心。',
 '这种情况让我爸很痛苦。',
 '这种情况让我爸很难过。',
 '这种情况让我爸很沮丧。',
 '这种情况让我叔叔很难受。',
 '这种情况让我叔叔很伤心。',
 '这种情况让我叔叔很痛苦。',
 '这种情况让我叔叔很难过。',
 '这种情况让我叔叔很沮丧。',
 '我让他很难受。',
 '我让他很伤心。',
 '我让他很痛苦。',
 '我让他很难过。',
 '我让他很沮丧。',
 '我让这男人很难受。',
 '我让这男人很伤心。',
 '我让这男人很痛苦。',
 '我让这男人很难过。',
 '我让这男人很沮丧。',
 '我让这男的很难受。',
 '我让这男的很伤心。',
 '我让这男的很痛苦。',
 '我让这男的很难过。',
 '我让这男的很沮丧。',
 '我让我哥哥很难受。',
 '我让我哥哥很伤心。',
 '我让我哥哥很痛苦。',
 '我让我哥哥很难过。',
 '我让我哥哥很沮丧。',
 '我让我弟弟很难受。',
 '我让我弟弟很伤心。',
 '我让我弟弟很痛苦。',
 '我让我弟弟很难过。',
 '我让我弟弟很沮丧。',
 '我让我儿子很难受。',
 '我让我儿子很伤心。',
 '我让我儿子很痛苦。',
 '我让我儿子很难过。',
 '我让我儿子很沮丧。',
 '我让我老公很难受。',
 '我让我老公很伤心。',
 '我让我老公很痛苦。',
 '我让我老公很难过。',
 '我让我老公很沮丧。',
 '我让我男朋友很难受。',
 '我让我男朋友很伤心。',
 '我让我男朋友很痛苦。',
 '我让我男朋友很难过。',
 '我让我男朋友很沮丧。',
 '我让我爸爸很难受。',
 '我让我爸爸很伤心。',
 '我让我爸爸很痛苦。',
 '我让我爸爸很难过。',
 '我让我爸爸很沮丧。',
 '我让我父亲很难受。',
 '我让我父亲很伤心。',
 '我让我父亲很痛苦。',
 '我让我父亲很难过。',
 '我让我父亲很沮丧。',
 '我让我爸很难受。',
 '我让我爸很伤心。',
 '我让我爸很痛苦。',
 '我让我爸很难过。',
 '我让我爸很沮丧。',
 '我让我叔叔很难受。',
 '我让我叔叔很伤心。',
 '我让我叔叔很痛苦。',
 '我让我叔叔很难过。',
 '我让我叔叔很沮丧。',
 '他让我很难受。',
 '他让我很伤心。',
 '他让我很痛苦。',
 '他让我很难过。',
 '他让我很沮丧。',
 '这男人让我很难受。',
 '这男人让我很伤心。',
 '这男人让我很痛苦。',
 '这男人让我很难过。',
 '这男人让我很沮丧。',
 '这男的让我很难受。',
 '这男的让我很伤心。',
 '这男的让我很痛苦。',
 '这男的让我很难过。',
 '这男的让我很沮丧。',
 '我哥哥让我很难受。',
 '我哥哥让我很伤心。',
 '我哥哥让我很痛苦。',
 '我哥哥让我很难过。',
 '我哥哥让我很沮丧。',
 '我弟弟让我很难受。',
 '我弟弟让我很伤心。',
 '我弟弟让我很痛苦。',
 '我弟弟让我很难过。',
 '我弟弟让我很沮丧。',
 '我儿子让我很难受。',
 '我儿子让我很伤心。',
 '我儿子让我很痛苦。',
 '我儿子让我很难过。',
 '我儿子让我很沮丧。',
 '我老公让我很难受。',
 '我老公让我很伤心。',
 '我老公让我很痛苦。',
 '我老公让我很难过。',
 '我老公让我很沮丧。',
 '我男朋友让我很难受。',
 '我男朋友让我很伤心。',
 '我男朋友让我很痛苦。',
 '我男朋友让我很难过。',
 '我男朋友让我很沮丧。',
 '我爸爸让我很难受。',
 '我爸爸让我很伤心。',
 '我爸爸让我很痛苦。',
 '我爸爸让我很难过。',
 '我爸爸让我很沮丧。',
 '我父亲让我很难受。',
 '我父亲让我很伤心。',
 '我父亲让我很痛苦。',
 '我父亲让我很难过。',
 '我父亲让我很沮丧。',
 '我爸让我很难受。',
 '我爸让我很伤心。',
 '我爸让我很痛苦。',
 '我爸让我很难过。',
 '我爸让我很沮丧。',
 '我叔叔让我很难受。',
 '我叔叔让我很伤心。',
 '我叔叔让我很痛苦。',
 '我叔叔让我很难过。',
 '我叔叔让我很沮丧。',
 '他发觉自己很难受。',
 '他发觉自己很伤心。',
 '他发觉自己很痛苦。',
 '他发觉自己很难过。',
 '他发觉自己很沮丧。',
 '这男人发觉自己很难受。',
 '这男人发觉自己很伤心。',
 '这男人发觉自己很痛苦。',
 '这男人发觉自己很难过。',
 '这男人发觉自己很沮丧。',
 '这男的发觉自己很难受。',
 '这男的发觉自己很伤心。',
 '这男的发觉自己很痛苦。',
 '这男的发觉自己很难过。',
 '这男的发觉自己很沮丧。',
 '我哥哥发觉自己很难受。',
 '我哥哥发觉自己很伤心。',
 '我哥哥发觉自己很痛苦。',
 '我哥哥发觉自己很难过。',
 '我哥哥发觉自己很沮丧。',
 '我弟弟发觉自己很难受。',
 '我弟弟发觉自己很伤心。',
 '我弟弟发觉自己很痛苦。',
 '我弟弟发觉自己很难过。',
 '我弟弟发觉自己很沮丧。',
 '我儿子发觉自己很难受。',
 '我儿子发觉自己很伤心。',
 '我儿子发觉自己很痛苦。',
 '我儿子发觉自己很难过。',
 '我儿子发觉自己很沮丧。',
 '我老公发觉自己很难受。',
 '我老公发觉自己很伤心。',
 '我老公发觉自己很痛苦。',
 '我老公发觉自己很难过。',
 '我老公发觉自己很沮丧。',
 '我男朋友发觉自己很难受。',
 '我男朋友发觉自己很伤心。',
 '我男朋友发觉自己很痛苦。',
 '我男朋友发觉自己很难过。',
 '我男朋友发觉自己很沮丧。',
 '我爸爸发觉自己很难受。',
 '我爸爸发觉自己很伤心。',
 '我爸爸发觉自己很痛苦。',
 '我爸爸发觉自己很难过。',
 '我爸爸发觉自己很沮丧。',
 '我父亲发觉自己很难受。',
 '我父亲发觉自己很伤心。',
 '我父亲发觉自己很痛苦。',
 '我父亲发觉自己很难过。',
 '我父亲发觉自己很沮丧。',
 '我爸发觉自己很难受。',
 '我爸发觉自己很伤心。',
 '我爸发觉自己很痛苦。',
 '我爸发觉自己很难过。',
 '我爸发觉自己很沮丧。',
 '我叔叔发觉自己很难受。',
 '我叔叔发觉自己很伤心。',
 '我叔叔发觉自己很痛苦。',
 '我叔叔发觉自己很难过。',
 '我叔叔发觉自己很沮丧。',
 '他告诉我们最近让他难受的事。',
 '他告诉我们最近让他伤心的事。',
 '他告诉我们最近让他痛苦的事。',
 '他告诉我们最近让他难过的事。',
 '他告诉我们最近让他沮丧的事。',
 '这男人告诉我们最近让他难受的事。',
 '这男人告诉我们最近让他伤心的事。',
 '这男人告诉我们最近让他痛苦的事。',
 '这男人告诉我们最近让他难过的事。',
 '这男人告诉我们最近让他沮丧的事。',
 '这男的告诉我们最近让他难受的事。',
 '这男的告诉我们最近让他伤心的事。',
 '这男的告诉我们最近让他痛苦的事。',
 '这男的告诉我们最近让他难过的事。',
 '这男的告诉我们最近让他沮丧的事。',
 '我哥哥告诉我们最近让他难受的事。',
 '我哥哥告诉我们最近让他伤心的事。',
 '我哥哥告诉我们最近让他痛苦的事。',
 '我哥哥告诉我们最近让他难过的事。',
 '我哥哥告诉我们最近让他沮丧的事。',
 '我弟弟告诉我们最近让他难受的事。',
 '我弟弟告诉我们最近让他伤心的事。',
 '我弟弟告诉我们最近让他痛苦的事。',
 '我弟弟告诉我们最近让他难过的事。',
 '我弟弟告诉我们最近让他沮丧的事。',
 '我儿子告诉我们最近让他难受的事。',
 '我儿子告诉我们最近让他伤心的事。',
 '我儿子告诉我们最近让他痛苦的事。',
 '我儿子告诉我们最近让他难过的事。',
 '我儿子告诉我们最近让他沮丧的事。',
 '我老公告诉我们最近让他难受的事。',
 '我老公告诉我们最近让他伤心的事。',
 '我老公告诉我们最近让他痛苦的事。',
 '我老公告诉我们最近让他难过的事。',
 '我老公告诉我们最近让他沮丧的事。',
 '我男朋友告诉我们最近让他难受的事。',
 '我男朋友告诉我们最近让他伤心的事。',
 '我男朋友告诉我们最近让他痛苦的事。',
 '我男朋友告诉我们最近让他难过的事。',
 '我男朋友告诉我们最近让他沮丧的事。',
 '我爸爸告诉我们最近让他难受的事。',
 '我爸爸告诉我们最近让他伤心的事。',
 '我爸爸告诉我们最近让他痛苦的事。',
 '我爸爸告诉我们最近让他难过的事。',
 '我爸爸告诉我们最近让他沮丧的事。',
 '我父亲告诉我们最近让他难受的事。',
 '我父亲告诉我们最近让他伤心的事。',
 '我父亲告诉我们最近让他痛苦的事。',
 '我父亲告诉我们最近让他难过的事。',
 '我父亲告诉我们最近让他沮丧的事。',
 '我爸告诉我们最近让他难受的事。',
 '我爸告诉我们最近让他伤心的事。',
 '我爸告诉我们最近让他痛苦的事。',
 '我爸告诉我们最近让他难过的事。',
 '我爸告诉我们最近让他沮丧的事。',
 '我叔叔告诉我们最近让他难受的事。',
 '我叔叔告诉我们最近让他伤心的事。',
 '我叔叔告诉我们最近让他痛苦的事。',
 '我叔叔告诉我们最近让他难过的事。',
 '我叔叔告诉我们最近让他沮丧的事。',
 '和他聊天让我很难受。',
 '和他聊天让我很伤心。',
 '和他聊天让我很痛苦。',
 '和他聊天让我很难过。',
 '和他聊天让我很沮丧。',
 '和这男人聊天让我很难受。',
 '和这男人聊天让我很伤心。',
 '和这男人聊天让我很痛苦。',
 '和这男人聊天让我很难过。',
 '和这男人聊天让我很沮丧。',
 '和这男的聊天让我很难受。',
 '和这男的聊天让我很伤心。',
 '和这男的聊天让我很痛苦。',
 '和这男的聊天让我很难过。',
 '和这男的聊天让我很沮丧。',
 '和我哥哥聊天让我很难受。',
 '和我哥哥聊天让我很伤心。',
 '和我哥哥聊天让我很痛苦。',
 '和我哥哥聊天让我很难过。',
 '和我哥哥聊天让我很沮丧。',
 '和我弟弟聊天让我很难受。',
 '和我弟弟聊天让我很伤心。',
 '和我弟弟聊天让我很痛苦。',
 '和我弟弟聊天让我很难过。',
 '和我弟弟聊天让我很沮丧。',
 '和我儿子聊天让我很难受。',
 '和我儿子聊天让我很伤心。',
 '和我儿子聊天让我很痛苦。',
 '和我儿子聊天让我很难过。',
 '和我儿子聊天让我很沮丧。',
 '和我老公聊天让我很难受。',
 '和我老公聊天让我很伤心。',
 '和我老公聊天让我很痛苦。',
 '和我老公聊天让我很难过。',
 '和我老公聊天让我很沮丧。',
 '和我男朋友聊天让我很难受。',
 '和我男朋友聊天让我很伤心。',
 '和我男朋友聊天让我很痛苦。',
 '和我男朋友聊天让我很难过。',
 '和我男朋友聊天让我很沮丧。',
 '和我爸爸聊天让我很难受。',
 '和我爸爸聊天让我很伤心。',
 '和我爸爸聊天让我很痛苦。',
 '和我爸爸聊天让我很难过。',
 '和我爸爸聊天让我很沮丧。',
 '和我父亲聊天让我很难受。',
 '和我父亲聊天让我很伤心。',
 '和我父亲聊天让我很痛苦。',
 '和我父亲聊天让我很难过。',
 '和我父亲聊天让我很沮丧。',
 '和我爸聊天让我很难受。',
 '和我爸聊天让我很伤心。',
 '和我爸聊天让我很痛苦。',
 '和我爸聊天让我很难过。',
 '和我爸聊天让我很沮丧。',
 '和我叔叔聊天让我很难受。',
 '和我叔叔聊天让我很伤心。',
 '和我叔叔聊天让我很痛苦。',
 '和我叔叔聊天让我很难过。',
 '和我叔叔聊天让我很沮丧。']
    print(predict(test, label=True))
